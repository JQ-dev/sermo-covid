# -*- coding: utf-8 -*-
"""
Created on Tue May 19 22:53:33 2020

@author: admin
"""

import pandas as pd

file = 'C:/Users/admin/Downloads/sermo-covid-19/sermo-covid-19-real-time-barometer-wave-'
sermo = pd.DataFrame()


##############################################################################
sermo12 = pd.read_csv(file+'12'+'.csv')

s12 = list(sermo12.columns)

# Removing irrelevant
sermo12 = sermo12.drop(
        ['Q3','Q4','Q5','Q8','Q12','Q16','Q19-1','Q19-2','Q19-3','Q19-4','Q19-5',
         'Q20-1','Q20-2','Q20-3','Q20-4','Q20-5','Q21-1','Q21-2','Q21-3','Q21-4','Q21-5','Q22-1',
         'Q22-2','Q22-3','Q22-4','Q22-5','Q22-6','Q22-7','Q22-8','Q23','Q24','Q25','Q26'],axis=1)


for i in list(sermo12.columns):
    if ('efficacy' in i or 'safety' in i):
        sermo12 = sermo12.drop(i,axis=1)


#changecol names1:
new_names = pd.DataFrame((       
['Q1','Q1x'],['Q2','Q2x'],['Q6','Q6x'],['Q6-1','Q6-1x'],['Q6-2','Q6-2x'],['Q6-3','Q6-3x'],['Q7','Q7x'],['Q9','Q9x'],['Q9-1','Q9-1x'],['Q9-2','Q9-2x'],['Q9-3','Q9-3x'],['Q9-4','Q9-4x'],['Q9-5','Q9-5x'],
['Q9-6','Q9-6x'],['Q9-7','Q9-7x'],['Q9-8','Q9-8x'],['Q9-9','Q9-9x'],['Q9-10','Q9-10x'],['Q9-11','Q9-11x'],['Q9-12','Q9-12x'],['Q9-13','Q9-13x'],['Q9-14','Q9-14x'],['Q9-15','Q9-15x'],['Q9-16','Q9-16x'],['Q9-17','Q9-17x'],['Q9-18','Q9-18x'],
['Q9-19','Q9-19x'],['Q9-20','Q9-20x'],['Q9-21','Q9-21x'],['Q9-22','Q9-22x'],['Q9-23','Q9-23x'],['Q9-24','Q9-24x'],['Q9-25','Q9-25x'],['Q9-26','Q9-26x'],['Q10','Q10x'],['Q10-1','Q10-1x'],['Q10-2','Q10-2x'],['Q10-3','Q10-3x'],['Q10-4','Q10-4x'],
['Q10-5','Q10-5x'],['Q10-6','Q10-6x'],['Q10-7','Q10-7x'],['Q10-8','Q10-8x'],['Q10-9','Q10-9x'],['Q10-10','Q10-10x'],['Q10-11','Q10-11x'],['Q10-12','Q10-12x'],['Q10-13','Q10-13x'],['Q10-14','Q10-14x'],['Q10-15','Q10-15x'],['Q10-16','Q10-16x'],['Q10-17','Q10-17x'],
['Q10-18','Q10-18x'],['Q10-19','Q10-19x'],['Q10-20','Q10-20x'],['Q10-21','Q10-21x'],['Q10-22','Q10-22x'],['Q10-23','Q10-23x'],['Q10-24','Q10-24x'],['Q10-25','Q10-25x'],['Q10-26','Q10-26x'],['Q11','Q11x'],['Q13','Q13x'],['Q13-1','Q13-1x'],['Q13-2','Q13-2x'],
['Q13-3','Q13-3x'],['Q13-4','Q13-4x'],['Q13-5','Q13-5x'],['Q13-6','Q13-6x'],['Q13-7','Q13-7x'],['Q13-8','Q13-8x'],['Q13-9','Q13-9x'],['Q13-10','Q13-10x'],['Q13-11','Q13-11x'],['Q13-12','Q13-12x'],['Q13-13','Q13-13x'],['Q13-14','Q13-14x'],['Q13-15','Q13-15x'],
['Q13-16','Q13-16x'],['Q13-17','Q13-17x'],['Q13-18','Q13-18x'],['Q13-19','Q13-19x'],['Q13-20','Q13-20x'],['Q13-21','Q13-21x'],['Q13-22','Q13-22x'],['Q13-23','Q13-23x'],['Q13-24','Q13-24x'],['Q13-25','Q13-25x'],['Q13-26','Q13-26x'],['Q14','Q14x'],['Q14-1','Q14-1x'],
['Q14-2','Q14-2x'],['Q14-3','Q14-3x'],['Q14-4','Q14-4x'],['Q14-5','Q14-5x'],['Q14-6','Q14-6x'],['Q14-7','Q14-7x'],['Q14-8','Q14-8x'],['Q14-9','Q14-9x'],['Q14-10','Q14-10x'],['Q14-11','Q14-11x'],['Q14-12','Q14-12x'],['Q14-13','Q14-13x'],['Q14-14','Q14-14x'],
['Q14-15','Q14-15x'],['Q14-16','Q14-16x'],['Q14-17','Q14-17x'],['Q14-18','Q14-18x'],['Q14-19','Q14-19x'],['Q14-20','Q14-20x'],['Q14-21','Q14-21x'],['Q14-22','Q14-22x'],['Q14-23','Q14-23x'],['Q14-24','Q14-24x'],['Q14-25','Q14-25x'],['Q14-26','Q14-26x'],['Q15','Q15x'],
['Q17','Q17x'],['Q17-1','Q17-1x'],['Q17-2','Q17-2x'],['Q17-3','Q17-3x'],['Q17-4','Q17-4x'],

['Q1x','Q1'],['Q2x','Q2'],['Q6x','Q7'],['Q6-1x','Q7-1'],['Q6-2x','Q7-2'],['Q6-3x','Q7-3'],['Q7x','Q8'],['Q9x','Q9'],['Q9-1x','Q9-1'],['Q9-2x','Q9-2'],['Q9-3x','Q9-3'],['Q9-4x','Q9-4'],['Q9-5x','Q9-25'],
['Q9-6x','Q9-6'],['Q9-7x','Q9-7'],['Q9-8x','Q9-8'],['Q9-9x','Q9-26'],['Q9-10x','Q9-9'],['Q9-11x','Q9-10'],['Q9-12x','Q9-13'],['Q9-13x','Q9-11'],['Q9-14x','Q9-12'],['Q9-15x','Q9-27'],['Q9-16x','Q9-14'],['Q9-17x','Q9-15'],['Q9-18x','Q9-16'],
['Q9-19x','Q9-17'],['Q9-20x','Q9-18'],['Q9-21x','Q9-19'],['Q9-22x','Q9-20'],['Q9-23x','Q9-21'],['Q9-24x','Q9-22'],['Q9-25x','Q9-23'],['Q9-26x','Q9-24'],['Q10x','Q10'],['Q10-1x','Q10-1'],['Q10-2x','Q10-2'],['Q10-3x','Q10-3'],['Q10-4x','Q10-4'],
['Q10-5x','Q10-25'],['Q10-6x','Q10-6'],['Q10-7x','Q10-7'],['Q10-8x','Q10-8'],['Q10-9x','Q10-26'],['Q10-10x','Q10-9'],['Q10-11x','Q10-10'],['Q10-12x','Q10-13'],['Q10-13x','Q10-11'],['Q10-14x','Q10-12'],['Q10-15x','Q10-27'],['Q10-16x','Q10-14'],['Q10-17x','Q10-15'],
['Q10-18x','Q10-16'],['Q10-19x','Q10-17'],['Q10-20x','Q10-18'],['Q10-21x','Q10-19'],['Q10-22x','Q10-20'],['Q10-23x','Q10-21'],['Q10-24x','Q10-22'],['Q10-25x','Q10-23'],['Q10-26x','Q10-24'],['Q11x','Q11'],['Q13x','Q12'],['Q13-1x','Q12-1'],['Q13-2x','Q12-2'],
['Q13-3x','Q12-3'],['Q13-4x','Q12-4'],['Q13-5x','Q12-25'],['Q13-6x','Q12-6'],['Q13-7x','Q12-7'],['Q13-8x','Q12-8'],['Q13-9x','Q12-26'],['Q13-10x','Q12-9'],['Q13-11x','Q12-10'],['Q13-12x','Q12-13'],['Q13-13x','Q12-11'],['Q13-14x','Q12-12'],['Q13-15x','Q12-27'],
['Q13-16x','Q12-14'],['Q13-17x','Q12-15'],['Q13-18x','Q12-16'],['Q13-19x','Q12-17'],['Q13-20x','Q12-18'],['Q13-21x','Q12-19'],['Q13-22x','Q12-20'],['Q13-23x','Q12-21'],['Q13-24x','Q12-22'],['Q13-25x','Q12-23'],['Q13-26x','Q12-24'],['Q14x','Q13'],['Q14-1x','Q13-1'],
['Q14-2x','Q13-2'],['Q14-3x','Q13-3'],['Q14-4x','Q13-4'],['Q14-5x','Q13-25'],['Q14-6x','Q13-6'],['Q14-7x','Q13-7'],['Q14-8x','Q13-8'],['Q14-9x','Q13-26'],['Q14-10x','Q13-9'],['Q14-11x','Q13-10'],['Q14-12x','Q13-13'],['Q14-13x','Q13-11'],['Q14-14x','Q13-12'],
['Q14-15x','Q13-27'],['Q14-16x','Q13-14'],['Q14-17x','Q13-15'],['Q14-18x','Q13-16'],['Q14-19x','Q13-17'],['Q14-20x','Q13-18'],['Q14-21x','Q13-19'],['Q14-22x','Q13-20'],['Q14-23x','Q13-21'],['Q14-24x','Q13-22'],['Q14-25x','Q13-23'],['Q14-26x','Q13-24'],['Q15x','Q14'],
['Q17x','Q15'],['Q17-1x','Q15-1'],['Q17-2x','Q15-2'],['Q17-3x','Q15-3'],['Q17-4x','Q15-4']
),columns=['new', 'old'])


for i in range(new_names.shape[0]):
    try:
        sermo12 = sermo12.rename(columns={ new_names.loc[i,'new'] : new_names.loc[i,'old'] })  
    except:
        continue


##############################################################################
sermo10 = pd.read_csv(file+'10'+'.csv')

# Removing irrelevant
sermo10 = sermo10.drop(
        ['Q9','Q13','Q17','Q20','Q21','Q22','Q23','Q24','Q25','Q26','Q27','Q28-1',
         'Q28-2','Q28-3','Q28-4','Q29','Q30-1','Q30-2','Q30-3','Q30-4','Q30-5','Q30-6','Q30-7','Q32'],axis=1)


for i in list(sermo10.columns):
    if ('efficacy' in i or 'safety' in i):
        sermo10 = sermo10.drop(i,axis=1)


#changecol names1:
new_names = pd.DataFrame((
['Q10','Q10x'],['Q10-1','Q10-1x'],['Q10-2','Q10-2x'],['Q10-3','Q10-3x'],['Q10-4','Q10-4x'],['Q10-5','Q10-5x'],['Q10-6','Q10-6x'],['Q10-7','Q10-7x'],['Q10-8','Q10-8x'],['Q10-9','Q10-9x'],['Q10-10','Q10-10x'],['Q10-11','Q10-11x'],['Q10-12','Q10-12x'],
['Q10-13','Q10-13x'],['Q10-14','Q10-14x'],['Q10-15','Q10-15x'],['Q10-16','Q10-16x'],['Q10-17','Q10-17x'],['Q10-18','Q10-18x'],['Q10-19','Q10-19x'],['Q10-20','Q10-20x'],['Q10-21','Q10-21x'],['Q10-22','Q10-22x'],['Q10-23','Q10-23x'],['Q10-24','Q10-24x'],['Q10-25','Q10-25x'],
['Q10-26','Q10-26x'],['Q11','Q11x'],['Q11-1','Q11-1x'],['Q11-2','Q11-2x'],['Q11-3','Q11-3x'],['Q11-4','Q11-4x'],['Q11-5','Q11-5x'],['Q11-6','Q11-6x'],['Q11-7','Q11-7x'],['Q11-8','Q11-8x'],['Q11-9','Q11-9x'],['Q11-10','Q11-10x'],['Q11-11','Q11-11x'],
['Q11-12','Q11-12x'],['Q11-13','Q11-13x'],['Q11-14','Q11-14x'],['Q11-15','Q11-15x'],['Q11-16','Q11-16x'],['Q11-17','Q11-17x'],['Q11-18','Q11-18x'],['Q11-19','Q11-19x'],['Q11-20','Q11-20x'],['Q11-21','Q11-21x'],['Q11-22','Q11-22x'],['Q11-23','Q11-23x'],['Q11-24','Q11-24x'],
['Q11-25','Q11-25x'],['Q11-26','Q11-26x'],['Q12','Q12x'],['Q14','Q14x'],['Q14-1','Q14-1x'],['Q14-2','Q14-2x'],['Q14-3','Q14-3x'],['Q14-4','Q14-4x'],['Q14-5','Q14-5x'],['Q14-6','Q14-6x'],['Q14-7','Q14-7x'],['Q14-8','Q14-8x'],['Q14-9','Q14-9x'],
['Q14-10','Q14-10x'],['Q14-11','Q14-11x'],['Q14-12','Q14-12x'],['Q14-13','Q14-13x'],['Q14-14','Q14-14x'],['Q14-15','Q14-15x'],['Q14-16','Q14-16x'],['Q14-17','Q14-17x'],['Q14-18','Q14-18x'],['Q14-19','Q14-19x'],['Q14-20','Q14-20x'],['Q14-21','Q14-21x'],['Q14-22','Q14-22x'],
['Q14-23','Q14-23x'],['Q14-24','Q14-24x'],['Q14-25','Q14-25x'],['Q14-26','Q14-26x'],['Q15','Q15x'],['Q15-1','Q15-1x'],['Q15-2','Q15-2x'],['Q15-3','Q15-3x'],['Q15-4','Q15-4x'],['Q15-5','Q15-5x'],['Q15-6','Q15-6x'],['Q15-7','Q15-7x'],['Q15-8','Q15-8x'],
['Q15-9','Q15-9x'],['Q15-10','Q15-10x'],['Q15-11','Q15-11x'],['Q15-12','Q15-12x'],['Q15-13','Q15-13x'],['Q15-14','Q15-14x'],['Q15-15','Q15-15x'],['Q15-16','Q15-16x'],['Q15-17','Q15-17x'],['Q15-18','Q15-18x'],['Q15-19','Q15-19x'],['Q15-20','Q15-20x'],['Q15-21','Q15-21x'],
['Q15-22','Q15-22x'],['Q15-23','Q15-23x'],['Q15-24','Q15-24x'],['Q15-25','Q15-25x'],['Q15-26','Q15-26x'],['Q16','Q16x'],['Q18','Q18x'],['Q18-1','Q18-1x'],['Q18-2','Q18-2x'],['Q18-3','Q18-3x'],['Q18-4','Q18-4x'],['Q18-5','Q18-5x'],['Q18-6','Q18-6x'],
['Q18-7','Q18-7x'],['Q18-8','Q18-8x'],['Q18-9','Q18-9x'],['Q18-10','Q18-10x'],['Q18-11','Q18-11x'],['Q18-12','Q18-12x'],['Q18-13','Q18-13x'],['Q18-14','Q18-14x'],['Q18-15','Q18-15x'],['Q18-16','Q18-16x'],['Q18-17','Q18-17x'],['Q18-18','Q18-18x'],['Q18-19','Q18-19x'],
['Q18-20','Q18-20x'],['Q18-21','Q18-21x'],['Q18-22','Q18-22x'],['Q18-23','Q18-23x'],['Q18-24','Q18-24x'],['Q18-25','Q18-25x'],['Q18-26','Q18-26x'],['Q19','Q19x'],['Q19-1','Q19-1x'],['Q19-2','Q19-2x'],['Q19-3','Q19-3x'],['Q19-4','Q19-4x'],['Q19-5','Q19-5x'],
['Q19-6','Q19-6x'],['Q19-7','Q19-7x'],['Q19-8','Q19-8x'],['Q19-9','Q19-9x'],['Q19-10','Q19-10x'],['Q19-11','Q19-11x'],['Q19-12','Q19-12x'],['Q19-13','Q19-13x'],['Q19-14','Q19-14x'],['Q19-15','Q19-15x'],['Q19-16','Q19-16x'],['Q19-17','Q19-17x'],['Q19-18','Q19-18x'],
['Q19-19','Q19-19x'],['Q19-20','Q19-20x'],['Q19-21','Q19-21x'],['Q19-22','Q19-22x'],['Q19-23','Q19-23x'],['Q19-24','Q19-24x'],['Q19-25','Q19-25x'],['Q19-26','Q19-26x'],['Q31','Q31x'],

['Q10x','Q9'],['Q10-1x','Q9-1'],['Q10-2x','Q9-2'],['Q10-3x','Q9-3'],['Q10-4x','Q9-4'],['Q10-5x','Q9-25'],['Q10-6x','Q9-6'],['Q10-7x','Q9-7'],['Q10-8x','Q9-8'],['Q10-9x','Q9-26'],['Q10-10x','Q9-9'],['Q10-11x','Q9-10'],['Q10-12x','Q9-13'],
['Q10-13x','Q9-11'],['Q10-14x','Q9-12'],['Q10-15x','Q9-27'],['Q10-16x','Q9-14'],['Q10-17x','Q9-15'],['Q10-18x','Q9-16'],['Q10-19x','Q9-17'],['Q10-20x','Q9-18'],['Q10-21x','Q9-19'],['Q10-22x','Q9-20'],['Q10-23x','Q9-21'],['Q10-24x','Q9-22'],['Q10-25x','Q9-23'],
['Q10-26x','Q9-24'],['Q11x','Q10'],['Q11-1x','Q10-1'],['Q11-2x','Q10-2'],['Q11-3x','Q10-3'],['Q11-4x','Q10-4'],['Q11-5x','Q10-25'],['Q11-6x','Q10-6'],['Q11-7x','Q10-7'],['Q11-8x','Q10-8'],['Q11-9x','Q10-26'],['Q11-10x','Q10-9'],['Q11-11x','Q10-10'],
['Q11-12x','Q10-13'],['Q11-13x','Q10-11'],['Q11-14x','Q10-12'],['Q11-15x','Q10-27'],['Q11-16x','Q10-14'],['Q11-17x','Q10-15'],['Q11-18x','Q10-16'],['Q11-19x','Q10-17'],['Q11-20x','Q10-18'],['Q11-21x','Q10-19'],['Q11-22x','Q10-20'],['Q11-23x','Q10-21'],['Q11-24x','Q10-22'],
['Q11-25x','Q10-23'],['Q11-26x','Q10-24'],['Q12x','Q11'],['Q14x','Q12'],['Q14-1x','Q12-1'],['Q14-2x','Q12-2'],['Q14-3x','Q12-3'],['Q14-4x','Q12-4'],['Q14-5x','Q12-25'],['Q14-6x','Q12-6'],['Q14-7x','Q12-7'],['Q14-8x','Q12-8'],['Q14-9x','Q12-26'],
['Q14-10x','Q12-9'],['Q14-11x','Q12-10'],['Q14-12x','Q12-13'],['Q14-13x','Q12-11'],['Q14-14x','Q12-12'],['Q14-15x','Q12-27'],['Q14-16x','Q12-14'],['Q14-17x','Q12-15'],['Q14-18x','Q12-16'],['Q14-19x','Q12-17'],['Q14-20x','Q12-18'],['Q14-21x','Q12-19'],['Q14-22x','Q12-20'],
['Q14-23x','Q12-21'],['Q14-24x','Q12-22'],['Q14-25x','Q12-23'],['Q14-26x','Q12-24'],['Q15x','Q13'],['Q15-1x','Q13-1'],['Q15-2x','Q13-2'],['Q15-3x','Q13-3'],['Q15-4x','Q13-4'],['Q15-5x','Q13-25'],['Q15-6x','Q13-6'],['Q15-7x','Q13-7'],['Q15-8x','Q13-8'],
['Q15-9x','Q13-26'],['Q15-10x','Q13-9'],['Q15-11x','Q13-10'],['Q15-12x','Q13-13'],['Q15-13x','Q13-11'],['Q15-14x','Q13-12'],['Q15-15x','Q13-27'],['Q15-16x','Q13-14'],['Q15-17x','Q13-15'],['Q15-18x','Q13-16'],['Q15-19x','Q13-17'],['Q15-20x','Q13-18'],['Q15-21x','Q13-19'],
['Q15-22x','Q13-20'],['Q15-23x','Q13-21'],['Q15-24x','Q13-22'],['Q15-25x','Q13-23'],['Q15-26x','Q13-24'],['Q16x','Q14'],['Q18x','Q15'],['Q18-1x','Q15-1'],['Q18-2x','Q15-2'],['Q18-3x','Q15-3'],['Q18-4x','Q15-4'],['Q18-5x','Q15-25'],['Q18-6x','Q15-6'],
['Q18-7x','Q15-7'],['Q18-8x','Q15-8'],['Q18-9x','Q15-26'],['Q18-10x','Q15-9'],['Q18-11x','Q15-10'],['Q18-12x','Q15-13'],['Q18-13x','Q15-11'],['Q18-14x','Q15-12'],['Q18-15x','Q15-27'],['Q18-16x','Q15-14'],['Q18-17x','Q15-15'],['Q18-18x','Q15-16'],['Q18-19x','Q15-17'],
['Q18-20x','Q15-18'],['Q18-21x','Q15-19'],['Q18-22x','Q15-20'],['Q18-23x','Q15-21'],['Q18-24x','Q15-22'],['Q18-25x','Q15-23'],['Q18-26x','Q15-24'],['Q19x','Q16'],['Q19-1x','Q16-1'],['Q19-2x','Q16-2'],['Q19-3x','Q16-3'],['Q19-4x','Q16-4'],['Q19-5x','Q16-25'],
['Q19-6x','Q16-6'],['Q19-7x','Q16-7'],['Q19-8x','Q16-8'],['Q19-9x','Q16-26'],['Q19-10x','Q16-9'],['Q19-11x','Q16-10'],['Q19-12x','Q16-13'],['Q19-13x','Q16-11'],['Q19-14x','Q16-12'],['Q19-15x','Q16-27'],['Q19-16x','Q16-14'],['Q19-17x','Q16-15'],['Q19-18x','Q16-16'],
['Q19-19x','Q16-17'],['Q19-20x','Q16-18'],['Q19-21x','Q16-19'],['Q19-22x','Q16-20'],['Q19-23x','Q16-21'],['Q19-24x','Q16-22'],['Q19-25x','Q16-23'],['Q19-26x','Q16-24'],['Q31x','Q32']
),columns=['new', 'old'])

for i in range(new_names.shape[0]):
    try:
        sermo10 = sermo10.rename(columns={ new_names.loc[i,'new'] : new_names.loc[i,'old'] })  
    except:
        continue


##############################################################################'Q27-3','Q27-4','Q27-5','Q27-6','Q28','Q29','Q30'
sermo9 = pd.read_csv(file+'9'+'.csv')

# Removing irrelevant
sermo9 = sermo9.drop(['Q9','Q13','Q17','Q20','Q21','Q22','Q23','Q24','Q25','Q26','Q27-1','Q27-2',
                      'Q27-1','Q27-2','Q27-3','Q27-4','Q27-5','Q27-6','Q28','Q29','Q30'],axis=1)

for i in list(sermo9.columns):
    if ('efficacy' in i or 'safety' in i):
        sermo9 = sermo9.drop(i,axis=1)
    
#changecol names:
new_names = pd.DataFrame((
['Q10','Q10x'],['Q10-1','Q10-1x'],
['Q10-2','Q10-2x'],['Q10-3','Q10-3x'],['Q10-4','Q10-4x'],['Q10-5','Q10-6x'],['Q10-6','Q10-7x'],['Q10-7','Q10-8x'],['Q10-8','Q10-9x'],['Q10-9','Q10-10x'],['Q10-10','Q10-11x'],['Q10-11','Q10-12x'],['Q10-12','Q10-13x'],['Q10-13','Q10-14x'],['Q10-14','Q10-16x'],
['Q10-15','Q10-17x'],['Q10-16','Q10-18x'],['Q10-17','Q10-19x'],['Q10-18','Q10-20x'],['Q10-19','Q10-21x'],['Q10-20','Q10-22x'],['Q10-21','Q10-23x'],['Q10-22','Q10-24x'],['Q10-23','Q10-25x'],['Q10-24','Q10-26x'],['Q11','Q11x'],['Q11-1','Q11-1x'],['Q11-2','Q11-2x'],
['Q11-3','Q11-3x'],['Q11-4','Q11-4x'],['Q11-5','Q11-6x'],['Q11-6','Q11-7x'],['Q11-7','Q11-8x'],['Q11-8','Q11-9x'],['Q11-9','Q11-10x'],['Q11-10','Q11-11x'],['Q11-11','Q11-12x'],['Q11-12','Q11-13x'],['Q11-13','Q11-14x'],['Q11-14','Q11-16x'],['Q11-15','Q11-17x'],
['Q11-16','Q11-18x'],['Q11-17','Q11-19x'],['Q11-18','Q11-20x'],['Q11-19','Q11-21x'],['Q11-20','Q11-22x'],['Q11-21','Q11-23x'],['Q11-22','Q11-24x'],['Q11-23','Q11-25x'],['Q11-24','Q11-26x'],['Q12','Q12x'],['Q14','Q14x'],['Q14-1','Q14-1x'],['Q14-2','Q14-2x'],
['Q14-3','Q14-3x'],['Q14-4','Q14-4x'],['Q14-5','Q14-6x'],['Q14-6','Q14-7x'],['Q14-7','Q14-8x'],['Q14-8','Q14-9x'],['Q14-9','Q14-10x'],['Q14-10','Q14-11x'],['Q14-11','Q14-12x'],['Q14-12','Q14-13x'],['Q14-13','Q14-14x'],['Q14-14','Q14-16x'],['Q14-15','Q14-17x'],
['Q14-16','Q14-18x'],['Q14-17','Q14-19x'],['Q14-18','Q14-20x'],['Q14-19','Q14-21x'],['Q14-20','Q14-22x'],['Q14-21','Q14-23x'],['Q14-22','Q14-24x'],['Q14-23','Q14-25x'],['Q14-24','Q14-26x'],['Q15','Q15x'],['Q15-1','Q15-1x'],['Q15-2','Q15-2x'],['Q15-3','Q15-3x'],
['Q15-4','Q15-4x'],['Q15-5','Q15-6x'],['Q15-6','Q15-7x'],['Q15-7','Q15-8x'],['Q15-8','Q15-9x'],['Q15-9','Q15-10x'],['Q15-10','Q15-11x'],['Q15-11','Q15-12x'],['Q15-12','Q15-13x'],['Q15-13','Q15-14x'],['Q15-14','Q15-16x'],['Q15-15','Q15-17x'],['Q15-16','Q15-18x'],
['Q15-17','Q15-19x'],['Q15-18','Q15-20x'],['Q15-19','Q15-21x'],['Q15-20','Q15-22x'],['Q15-21','Q15-23x'],['Q15-22','Q15-24x'],['Q15-23','Q15-25x'],['Q15-24','Q15-26x'],['Q16','Q16x'],['Q18','Q18x'],['Q18-1','Q18-1x'],['Q18-2','Q18-2x'],['Q18-3','Q18-3x'],
['Q18-4','Q18-4x'],['Q18-5','Q18-6x'],['Q18-6','Q18-7x'],['Q18-7','Q18-8x'],['Q18-8','Q18-9x'],['Q18-9','Q18-10x'],['Q18-10','Q18-11x'],['Q18-11','Q18-12x'],['Q18-12','Q18-13x'],['Q18-13','Q18-14x'],['Q18-14','Q18-16x'],['Q18-15','Q18-17x'],['Q18-16','Q18-18x'],
['Q18-17','Q18-19x'],['Q18-18','Q18-20x'],['Q18-19','Q18-21x'],['Q18-20','Q18-22x'],['Q18-21','Q18-23x'],['Q18-22','Q18-24x'],['Q18-23','Q18-25x'],['Q18-24','Q18-26x'],['Q19','Q19x'],['Q19-1','Q19-1x'],['Q19-2','Q19-2x'],['Q19-3','Q19-3x'],['Q19-4','Q19-4x'],
['Q19-5','Q19-6x'],['Q19-6','Q19-7x'],['Q19-7','Q19-8x'],['Q19-8','Q19-9x'],['Q19-9','Q19-10x'],['Q19-10','Q19-11x'],['Q19-11','Q19-12x'],['Q19-12','Q19-13x'],['Q19-13','Q19-14x'],['Q19-14','Q19-16x'],['Q19-15','Q19-17x'],['Q19-16','Q19-18x'],['Q19-17','Q19-19x'],
['Q19-18','Q19-20x'],['Q19-19','Q19-21x'],['Q19-20','Q19-22x'],['Q19-21','Q19-23x'],['Q19-22','Q19-24x'],['Q19-23','Q19-25x'],['Q19-24','Q19-26x'],['Q31','Q31x'],

['Q10-1x','Q9-1'],['Q10-2x','Q9-2'],['Q10-3x','Q9-3'],['Q10-4x','Q9-4'],['Q10-6x','Q9-6'],['Q10-7x','Q9-7'],['Q10-8x','Q9-8'],['Q10-9x','Q9-26'],['Q10-10x','Q9-9'],['Q10-11x','Q9-10'],['Q10-12x','Q9-13'],['Q10-13x','Q9-11'],['Q10-14x','Q9-12'],['Q10-16x','Q9-14'],
['Q10-17x','Q9-15'],['Q10-18x','Q9-16'],['Q10-19x','Q9-17'],['Q10-20x','Q9-18'],['Q10-21x','Q9-19'],['Q10-22x','Q9-20'],['Q10-23x','Q9-21'],['Q10-24x','Q9-22'],['Q10-25x','Q9-23'],['Q10-26x','Q9-24'],['Q11x','Q10'],['Q11-1x','Q10-1'],['Q11-2x','Q10-2'],
['Q11-3x','Q10-3'],['Q11-4x','Q10-4'],['Q11-6x','Q10-6'],['Q11-7x','Q10-7'],['Q11-8x','Q10-8'],['Q11-9x','Q10-26'],['Q11-10x','Q10-9'],['Q11-11x','Q10-10'],['Q11-12x','Q10-13'],['Q11-13x','Q10-11'],['Q11-14x','Q10-12'],['Q11-16x','Q10-14'],['Q11-17x','Q10-15'],
['Q11-18x','Q10-16'],['Q11-19x','Q10-17'],['Q11-20x','Q10-18'],['Q11-21x','Q10-19'],['Q11-22x','Q10-20'],['Q11-23x','Q10-21'],['Q11-24x','Q10-22'],['Q11-25x','Q10-23'],['Q11-26x','Q10-24'],['Q12x','Q11'],['Q14x','Q12'],['Q14-1x','Q12-1'],['Q14-2x','Q12-2'],
['Q14-3x','Q12-3'],['Q14-4x','Q12-4'],['Q14-6x','Q12-6'],['Q14-7x','Q12-7'],['Q14-8x','Q12-8'],['Q14-9x','Q12-26'],['Q14-10x','Q12-9'],['Q14-11x','Q12-10'],['Q14-12x','Q12-13'],['Q14-13x','Q12-11'],['Q14-14x','Q12-12'],['Q14-16x','Q12-14'],['Q14-17x','Q12-15'],
['Q14-18x','Q12-16'],['Q14-19x','Q12-17'],['Q14-20x','Q12-18'],['Q14-21x','Q12-19'],['Q14-22x','Q12-20'],['Q14-23x','Q12-21'],['Q14-24x','Q12-22'],['Q14-25x','Q12-23'],['Q14-26x','Q12-24'],['Q15x','Q13'],['Q15-1x','Q13-1'],['Q15-2x','Q13-2'],['Q15-3x','Q13-3'],
['Q15-4x','Q13-4'],['Q15-6x','Q13-6'],['Q15-7x','Q13-7'],['Q15-8x','Q13-8'],['Q15-9x','Q13-26'],['Q15-10x','Q13-9'],['Q15-11x','Q13-10'],['Q15-12x','Q13-13'],['Q15-13x','Q13-11'],['Q15-14x','Q13-12'],['Q15-16x','Q13-14'],['Q15-17x','Q13-15'],['Q15-18x','Q13-16'],
['Q15-19x','Q13-17'],['Q15-20x','Q13-18'],['Q15-21x','Q13-19'],['Q15-22x','Q13-20'],['Q15-23x','Q13-21'],['Q15-24x','Q13-22'],['Q15-25x','Q13-23'],['Q15-26x','Q13-24'],['Q16x','Q14'],['Q18x','Q15'],['Q18-1x','Q15-1'],['Q18-2x','Q15-2'],['Q18-3x','Q15-3'],
['Q18-4x','Q15-4'],['Q18-6x','Q15-6'],['Q18-7x','Q15-7'],['Q18-8x','Q15-8'],['Q18-9x','Q15-26'],['Q18-10x','Q15-9'],['Q18-11x','Q15-10'],['Q18-12x','Q15-13'],['Q18-13x','Q15-11'],['Q18-14x','Q15-12'],['Q18-16x','Q15-14'],['Q18-17x','Q15-15'],['Q18-18x','Q15-16'],
['Q18-19x','Q15-17'],['Q18-20x','Q15-18'],['Q18-21x','Q15-19'],['Q18-22x','Q15-20'],['Q18-23x','Q15-21'],['Q18-24x','Q15-22'],['Q18-25x','Q15-23'],['Q18-26x','Q15-24'],['Q19x','Q16'],['Q19-1x','Q16-1'],['Q19-2x','Q16-2'],['Q19-3x','Q16-3'],['Q19-4x','Q16-4'],
['Q19-6x','Q16-6'],['Q19-7x','Q16-7'],['Q19-8x','Q16-8'],['Q19-9x','Q16-26'],['Q19-10x','Q16-9'],['Q19-11x','Q16-10'],['Q19-12x','Q16-13'],['Q19-13x','Q16-11'],['Q19-14x','Q16-12'],['Q19-16x','Q16-14'],['Q19-17x','Q16-15'],['Q19-18x','Q16-16'],['Q19-19x','Q16-17'],
['Q19-20x','Q16-18'],['Q19-21x','Q16-19'],['Q19-22x','Q16-20'],['Q19-23x','Q16-21'],['Q19-24x','Q16-22'],['Q19-25x','Q16-23'],['Q19-26x','Q16-24'],['Q31x','Q32']
),columns=['new', 'old'])

for i in range(new_names.shape[0]):
    try:
        sermo9 = sermo9.rename(columns={ new_names.loc[i,'new'] : new_names.loc[i,'old'] })  
    except:
        continue

del new_names, i


##############################################################################
sermo8 = pd.read_csv(file+'8'+'.csv')

# Removing irrelevant
sermo8 = sermo8.drop(['Q9','Q13','Q17','Q20','Q21','Q22','Q23','Q24','Q25','Q26','Q27','Q28','Q29',
                      'Q30','Q31','Q32','Q33','Q34','Q35','Q36','Q37'],axis=1)


for i in list(sermo8.columns):
    if ('efficacy' in i or 'safety' in i):
        sermo8 = sermo8.drop(i,axis=1)


#changecol names:
new_names = pd.DataFrame((
['Q10','Q10x'],['Q10-1','Q10-1x'],['Q10-2','Q10-2x'],['Q10-3','Q10-3x'],['Q10-4','Q10-4x'],['Q10-5','Q10-6x'],['Q10-6','Q10-7x'],['Q10-7','Q10-8x'],['Q10-8','Q10-9x'],['Q10-9','Q10-10x'],['Q10-10','Q10-11x'],['Q10-11','Q10-12x'],['Q10-12','Q10-13x'],
['Q10-13','Q10-14x'],['Q10-14','Q10-16x'],['Q10-15','Q10-17x'],['Q10-16','Q10-18x'],['Q10-17','Q10-19x'],['Q10-18','Q10-20x'],['Q10-19','Q10-21x'],['Q10-20','Q10-22x'],['Q10-21','Q10-23x'],['Q10-22','Q10-24x'],['Q10-23','Q10-25x'],['Q10-24','Q10-26x'],['Q15','Q11x'],
['Q11-1','Q11-1x'],['Q11-2','Q11-2x'],['Q11-3','Q11-3x'],['Q11-4','Q11-4x'],['Q11-5','Q11-6x'],['Q11-6','Q11-7x'],['Q11-7','Q11-8x'],['Q11-8','Q11-9x'],['Q11-9','Q11-10x'],['Q11-10','Q11-11x'],['Q11-11','Q11-12x'],['Q11-12','Q11-13x'],['Q11-13','Q11-14x'],
['Q11-14','Q11-16x'],['Q11-15','Q11-17x'],['Q11-16','Q11-18x'],['Q11-17','Q11-19x'],['Q11-18','Q11-20x'],['Q11-19','Q11-21x'],['Q11-20','Q11-22x'],['Q11-21','Q11-23x'],['Q11-22','Q11-24x'],['Q11-23','Q11-25x'],['Q11-24','Q11-26x'],['Q12','Q12x'],['Q14','Q14x'],
['Q14-1','Q14-1x'],['Q14-2','Q14-2x'],['Q14-3','Q14-3x'],['Q14-4','Q14-4x'],['Q14-5','Q14-6x'],['Q14-6','Q14-7x'],['Q14-7','Q14-8x'],['Q14-8','Q14-9x'],['Q14-9','Q14-10x'],['Q14-10','Q14-11x'],['Q14-11','Q14-12x'],['Q14-12','Q14-13x'],['Q14-13','Q14-14x'],
['Q14-14','Q14-16x'],['Q14-15','Q14-17x'],['Q14-16','Q14-18x'],['Q14-17','Q14-19x'],['Q14-18','Q14-20x'],['Q14-19','Q14-21x'],['Q14-20','Q14-22x'],['Q14-21','Q14-23x'],['Q14-22','Q14-24x'],['Q14-23','Q14-25x'],['Q14-24','Q14-26x'],['Q15','Q15x'],['Q15-1','Q15-1x'],
['Q15-2','Q15-2x'],['Q15-3','Q15-3x'],['Q15-4','Q15-4x'],['Q15-5','Q15-6x'],['Q15-6','Q15-7x'],['Q15-7','Q15-8x'],['Q15-8','Q15-9x'],['Q15-9','Q15-10x'],['Q15-10','Q15-11x'],['Q15-11','Q15-12x'],['Q15-12','Q15-13x'],['Q15-13','Q15-14x'],['Q15-14','Q15-16x'],
['Q15-15','Q15-17x'],['Q15-16','Q15-18x'],['Q15-17','Q15-19x'],['Q15-18','Q15-20x'],['Q15-19','Q15-21x'],['Q15-20','Q15-22x'],['Q15-21','Q15-23x'],['Q15-22','Q15-24x'],['Q15-23','Q15-25x'],['Q15-24','Q15-26x'],['Q16','Q16x'],['Q18','Q18x'],['Q18-1','Q18-1x'],
['Q18-2','Q18-2x'],['Q18-3','Q18-3x'],['Q18-4','Q18-4x'],['Q18-5','Q18-6x'],['Q18-6','Q18-7x'],['Q18-7','Q18-8x'],['Q18-8','Q18-9x'],['Q18-9','Q18-10x'],['Q18-10','Q18-11x'],['Q18-11','Q18-12x'],['Q18-12','Q18-13x'],['Q18-13','Q18-14x'],['Q18-14','Q18-16x'],
['Q18-15','Q18-17x'],['Q18-16','Q18-18x'],['Q18-17','Q18-19x'],['Q18-18','Q18-20x'],['Q18-19','Q18-21x'],['Q18-20','Q18-22x'],['Q18-21','Q18-23x'],['Q18-22','Q18-24x'],['Q18-23','Q18-25x'],['Q18-24','Q18-26x'],['Q19','Q19x'],['Q19-1','Q19-1x'],['Q19-2','Q19-2x'],
['Q19-3','Q19-3x'],['Q19-4','Q19-4x'],['Q19-5','Q19-6x'],['Q19-6','Q19-7x'],['Q19-7','Q19-8x'],['Q19-8','Q19-9x'],['Q19-9','Q19-10x'],['Q19-10','Q19-11x'],['Q19-11','Q19-12x'],['Q19-12','Q19-13x'],['Q19-13','Q19-14x'],['Q19-14','Q19-16x'],['Q19-15','Q19-17x'],
['Q19-16','Q19-18x'],['Q19-17','Q19-19x'],['Q19-18','Q19-20x'],['Q19-19','Q19-21x'],['Q19-20','Q19-22x'],['Q19-21','Q19-23x'],['Q19-22','Q19-24x'],['Q19-23','Q19-25x'],['Q19-24','Q19-26x'],['Q38','Q31x'],

['Q10x','Q9'],['Q10-1x','Q9-1'],['Q10-2x','Q9-2'],['Q10-3x','Q9-3'],['Q10-4x','Q9-4'],['Q10-6x','Q9-6'],['Q10-7x','Q9-7'],['Q10-8x','Q9-8'],['Q10-9x','Q9-26'],['Q10-10x','Q9-9'],['Q10-11x','Q9-10'],['Q10-12x','Q9-13'],['Q10-13x','Q9-11'],
['Q10-14x','Q9-12'],['Q10-16x','Q9-14'],['Q10-17x','Q9-15'],['Q10-18x','Q9-16'],['Q10-19x','Q9-17'],['Q10-20x','Q9-18'],['Q10-21x','Q9-19'],['Q10-22x','Q9-20'],['Q10-23x','Q9-21'],['Q10-24x','Q9-22'],['Q10-25x','Q9-23'],['Q10-26x','Q9-24'],['Q11x','Q10'],
['Q11-1x','Q10-1'],['Q11-2x','Q10-2'],['Q11-3x','Q10-3'],['Q11-4x','Q10-4'],['Q11-6x','Q10-6'],['Q11-7x','Q10-7'],['Q11-8x','Q10-8'],['Q11-9x','Q10-26'],['Q11-10x','Q10-9'],['Q11-11x','Q10-10'],['Q11-12x','Q10-13'],['Q11-13x','Q10-11'],['Q11-14x','Q10-12'],
['Q11-16x','Q10-14'],['Q11-17x','Q10-15'],['Q11-18x','Q10-16'],['Q11-19x','Q10-17'],['Q11-20x','Q10-18'],['Q11-21x','Q10-19'],['Q11-22x','Q10-20'],['Q11-23x','Q10-21'],['Q11-24x','Q10-22'],['Q11-25x','Q10-23'],['Q11-26x','Q10-24'],['Q12x','Q11'],['Q14x','Q12'],
['Q14-1x','Q12-1'],['Q14-2x','Q12-2'],['Q14-3x','Q12-3'],['Q14-4x','Q12-4'],['Q14-6x','Q12-6'],['Q14-7x','Q12-7'],['Q14-8x','Q12-8'],['Q14-9x','Q12-26'],['Q14-10x','Q12-9'],['Q14-11x','Q12-10'],['Q14-12x','Q12-13'],['Q14-13x','Q12-11'],['Q14-14x','Q12-12'],
['Q14-16x','Q12-14'],['Q14-17x','Q12-15'],['Q14-18x','Q12-16'],['Q14-19x','Q12-17'],['Q14-20x','Q12-18'],['Q14-21x','Q12-19'],['Q14-22x','Q12-20'],['Q14-23x','Q12-21'],['Q14-24x','Q12-22'],['Q14-25x','Q12-23'],['Q14-26x','Q12-24'],['Q15x','Q13'],['Q15-1x','Q13-1'],
['Q15-2x','Q13-2'],['Q15-3x','Q13-3'],['Q15-4x','Q13-4'],['Q15-6x','Q13-6'],['Q15-7x','Q13-7'],['Q15-8x','Q13-8'],['Q15-9x','Q13-26'],['Q15-10x','Q13-9'],['Q15-11x','Q13-10'],['Q15-12x','Q13-13'],['Q15-13x','Q13-11'],['Q15-14x','Q13-12'],['Q15-16x','Q13-14'],
['Q15-17x','Q13-15'],['Q15-18x','Q13-16'],['Q15-19x','Q13-17'],['Q15-20x','Q13-18'],['Q15-21x','Q13-19'],['Q15-22x','Q13-20'],['Q15-23x','Q13-21'],['Q15-24x','Q13-22'],['Q15-25x','Q13-23'],['Q15-26x','Q13-24'],['Q16x','Q14'],['Q18x','Q15'],['Q18-1x','Q15-1'],
['Q18-2x','Q15-2'],['Q18-3x','Q15-3'],['Q18-4x','Q15-4'],['Q18-6x','Q15-6'],['Q18-7x','Q15-7'],['Q18-8x','Q15-8'],['Q18-9x','Q15-26'],['Q18-10x','Q15-9'],['Q18-11x','Q15-10'],['Q18-12x','Q15-13'],['Q18-13x','Q15-11'],['Q18-14x','Q15-12'],['Q18-16x','Q15-14'],
['Q18-17x','Q15-15'],['Q18-18x','Q15-16'],['Q18-19x','Q15-17'],['Q18-20x','Q15-18'],['Q18-21x','Q15-19'],['Q18-22x','Q15-20'],['Q18-23x','Q15-21'],['Q18-24x','Q15-22'],['Q18-25x','Q15-23'],['Q18-26x','Q15-24'],['Q19x','Q16'],['Q19-1x','Q16-1'],['Q19-2x','Q16-2'],
['Q19-3x','Q16-3'],['Q19-4x','Q16-4'],['Q19-6x','Q16-6'],['Q19-7x','Q16-7'],['Q19-8x','Q16-8'],['Q19-9x','Q16-26'],['Q19-10x','Q16-9'],['Q19-11x','Q16-10'],['Q19-12x','Q16-13'],['Q19-13x','Q16-11'],['Q19-14x','Q16-12'],['Q19-16x','Q16-14'],['Q19-17x','Q16-15'],
['Q19-18x','Q16-16'],['Q19-19x','Q16-17'],['Q19-20x','Q16-18'],['Q19-21x','Q16-19'],['Q19-22x','Q16-20'],['Q19-23x','Q16-21'],['Q19-24x','Q16-22'],['Q19-25x','Q16-23'],['Q19-26x','Q16-24'],['Q31x','Q32']       
),columns=['new', 'old'])

for i in range(new_names.shape[0]):
    try:
        sermo8 = sermo8.rename(columns={ new_names.loc[i,'new'] : new_names.loc[i,'old'] })  
    except:
        continue

del new_names, i
##############################################################################
sermo7 = pd.read_csv(file+'7'+'.csv')

sermo7 = sermo7.drop(['Q17','Q18','Q19','Q20','Q21','Q22','Q23','Q24','Q25','Q26','Q27','Q28','Q29','Q30','Q31'],axis=1)

for i in list(sermo7.columns):
    if ('efficacy' in i or 'safety' in i):
        sermo7 = sermo7.drop(i,axis=1)


##############################################################################
sermo6 = pd.read_csv(file+'6'+'.csv')

# Removing irrelevant
sermo6 = sermo6.drop(['Q17','Q18','Q19','Q20','Q21','Q22','Q23','Q24','Q25','Q26','Q27','Q28'],axis=1)

for i in list(sermo6.columns):
    if ('efficacy' in i or 'safety' in i):
        sermo6 = sermo6.drop(i,axis=1)


# Renaming to match sermo7
new_names = pd.DataFrame((			
['Q9','Q10x'],['Q9-1','Q10-1x'],['Q9-2','Q10-2x'],['Q9-3','Q10-3x'],['Q9-4','Q10-4x'],['Q9-5','Q9-05x'],['Q9-6','Q10-6x'],['Q9-7','Q10-7x'],['Q9-8','Q10-8x'],['Q9-9','Q10-10x'],['Q9-10','Q10-11x'],['Q9-13','Q10-12x'],['Q9-11','Q10-13x'],
['Q9-12','Q10-14x'],['Q9-14','Q10-16x'],['Q9-15','Q10-17x'],['Q9-16','Q10-18x'],['Q9-17','Q10-19x'],['Q10','Q11x'],['Q10-1','Q11-1x'],['Q10-2','Q11-2x'],['Q10-3','Q11-3x'],['Q10-4','Q11-4x'],['Q10-5','Q10-05x'],['Q10-6','Q11-6x'],['Q10-7','Q11-7x'],
['Q10-8','Q11-8x'],['Q10-9','Q11-10x'],['Q10-10','Q11-11x'],['Q10-13','Q11-12x'],['Q10-11','Q11-13x'],['Q10-12','Q11-14x'],['Q10-14','Q11-16x'],['Q10-15','Q11-17x'],['Q10-16','Q11-18x'],['Q10-17','Q11-19x'],['Q12','Q14x'],['Q12-1','Q14-1x'],['Q12-2','Q14-2x'],
['Q12-3','Q14-3x'],['Q12-4','Q14-4x'],['Q12-5','Q12-05x'],['Q12-6','Q14-6x'],['Q12-7','Q14-7x'],['Q12-8','Q14-8x'],['Q12-9','Q14-10x'],['Q12-10','Q14-11x'],['Q12-13','Q14-12x'],['Q12-11','Q14-13x'],['Q12-12','Q14-14x'],['Q12-14','Q14-16x'],['Q12-15','Q14-17x'],
['Q12-16','Q14-18x'],['Q12-17','Q14-19x'],['Q13','Q15x'],['Q13-1','Q15-1x'],['Q13-2','Q15-2x'],['Q13-3','Q15-3x'],['Q13-4','Q15-4x'],['Q13-5','Q13-05x'],['Q13-6','Q15-6x'],['Q13-7','Q15-7x'],['Q13-8','Q15-8x'],['Q13-9','Q15-10x'],['Q13-10','Q15-11x'],
['Q13-13','Q15-12x'],['Q13-11','Q15-13x'],['Q13-12','Q15-14x'],['Q13-14','Q15-16x'],['Q13-15','Q15-17x'],['Q13-16','Q15-18x'],['Q13-17','Q15-19x'],['Q14','Q16x'],['Q15','Q18x'],['Q15-1','Q18-1x'],['Q15-2','Q18-2x'],['Q15-3','Q18-3x'],['Q15-4','Q18-4x'],
['Q15-5','Q15-05x'],['Q15-6','Q18-6x'],['Q15-7','Q18-7x'],['Q15-8','Q18-8x'],['Q15-9','Q18-10x'],['Q15-10','Q18-11x'],['Q15-13','Q18-12x'],['Q15-11','Q18-13x'],['Q15-12','Q18-14x'],['Q15-14','Q18-16x'],['Q15-15','Q18-17x'],['Q15-16','Q18-18x'],['Q15-17','Q18-19x'],
['Q16','Q19x'],['Q16-1','Q19-1x'],['Q16-2','Q19-2x'],['Q16-3','Q19-3x'],['Q16-4','Q19-4x'],['Q16-6','Q19-6x'],['Q16-7','Q19-7x'],['Q16-8','Q19-8x'],['Q16-9','Q19-10x'],['Q16-10','Q19-11x'],['Q16-13','Q19-12x'],['Q16-11','Q19-13x'],['Q16-12','Q19-14x'],
['Q16-14','Q19-16x'],['Q16-15','Q19-17x'],['Q16-16','Q19-18x'],['Q16-17','Q19-19x'],['Q29','Q31x'],

['Q10x','Q9'],['Q10-1x','Q9-1'],['Q10-2x','Q9-2'],['Q10-3x','Q9-3'],['Q10-4x','Q9-4'],['Q9-05x','Q9-5'],['Q10-6x','Q9-6'],['Q10-7x','Q9-7'],['Q10-8x','Q9-8'],['Q10-10x','Q9-9'],['Q10-11x','Q9-10'],['Q10-12x','Q9-13'],['Q10-13x','Q9-11'],
['Q10-14x','Q9-12'],['Q10-16x','Q9-14'],['Q10-17x','Q9-15'],['Q10-18x','Q9-16'],['Q10-19x','Q9-17'],['Q11x','Q10'],['Q11-1x','Q10-1'],['Q11-2x','Q10-2'],['Q11-3x','Q10-3'],['Q11-4x','Q10-4'],['Q10-05x','Q10-5'],['Q11-6x','Q10-6'],['Q11-7x','Q10-7'],
['Q11-8x','Q10-8'],['Q11-10x','Q10-9'],['Q11-11x','Q10-10'],['Q11-12x','Q10-13'],['Q11-13x','Q10-11'],['Q11-14x','Q10-12'],['Q11-16x','Q10-14'],['Q11-17x','Q10-15'],['Q11-18x','Q10-16'],['Q11-19x','Q10-17'],['Q14x','Q12'],['Q14-1x','Q12-1'],['Q14-2x','Q12-2'],
['Q14-3x','Q12-3'],['Q14-4x','Q12-4'],['Q12-05x','Q12-5'],['Q14-6x','Q12-6'],['Q14-7x','Q12-7'],['Q14-8x','Q12-8'],['Q14-10x','Q12-9'],['Q14-11x','Q12-10'],['Q14-12x','Q12-13'],['Q14-13x','Q12-11'],['Q14-14x','Q12-12'],['Q14-16x','Q12-14'],['Q14-17x','Q12-15'],
['Q14-18x','Q12-16'],['Q14-19x','Q12-17'],['Q15x','Q13'],['Q15-1x','Q13-1'],['Q15-2x','Q13-2'],['Q15-3x','Q13-3'],['Q15-4x','Q13-4'],['Q13-05x','Q13-5'],['Q15-6x','Q13-6'],['Q15-7x','Q13-7'],['Q15-8x','Q13-8'],['Q15-10x','Q13-9'],['Q15-11x','Q13-10'],
['Q15-12x','Q13-13'],['Q15-13x','Q13-11'],['Q15-14x','Q13-12'],['Q15-16x','Q13-14'],['Q15-17x','Q13-15'],['Q15-18x','Q13-16'],['Q15-19x','Q13-17'],['Q16x','Q14'],['Q18x','Q15'],['Q18-1x','Q15-1'],['Q18-2x','Q15-2'],['Q18-3x','Q15-3'],['Q18-4x','Q15-4'],
['Q15-05x','Q15-5'],['Q18-6x','Q15-6'],['Q18-7x','Q15-7'],['Q18-8x','Q15-8'],['Q18-10x','Q15-9'],['Q18-11x','Q15-10'],['Q18-12x','Q15-13'],['Q18-13x','Q15-11'],['Q18-14x','Q15-12'],['Q18-16x','Q15-14'],['Q18-17x','Q15-15'],['Q18-18x','Q15-16'],['Q18-19x','Q15-17'],
['Q19x','Q16'],['Q19-1x','Q16-1'],['Q19-2x','Q16-2'],['Q19-3x','Q16-3'],['Q19-4x','Q16-4'],['Q19-6x','Q16-6'],['Q19-7x','Q16-7'],['Q19-8x','Q16-8'],['Q19-10x','Q16-9'],['Q19-11x','Q16-10'],['Q19-12x','Q16-13'],['Q19-13x','Q16-11'],['Q19-14x','Q16-12'],
['Q19-16x','Q16-14'],['Q19-17x','Q16-15'],['Q19-18x','Q16-16'],['Q19-19x','Q16-17'],['Q31x','Q32']
),columns=['new', 'old'])

for i in range(new_names.shape[0]):
    try:
        sermo6 = sermo6.rename(columns={ new_names.loc[i,'new'] : new_names.loc[i,'old'] })  
    except:
        continue

del new_names, i
##############################################################################
sermo5 = pd.read_csv(file+'5'+'.csv')

sermo5 = sermo5.drop(  ['Q9','Q17','Q18','Q19','Q20','Q21-1','Q21-2','Q22-1','Q22-2','Q22-3','Q22-4',
                        'Q22-5','Q27','Q22-6','Q22-7','Q22-8','Q23','Q24','Q25','Q28','Q12-17','Q12-5','Q13-5','Q13-17',
                        'Q14-5','Q14-17','Q15-5','Q15-17','Q16-5','Q16-17','Q11-17','Q11-5'],axis=1)


for i in list(sermo5.columns):
    if ('efficacy' in i or 'safety' in i):
        sermo5 = sermo5.drop(i,axis=1)    
    
   	
 
new_names = pd.DataFrame((
['Q11','Q11x'],['Q11-19','Q11-19x'],['Q11-3','Q11-3x'],['Q11-20','Q11-20x'],['Q11-6','Q11-6x'],['Q11-16','Q11-16x'],['Q11-1','Q11-1x'],['Q11-7','Q11-7x'],['Q11-13','Q11-13x'],['Q11-9','Q11-9x'],['Q11-15','Q11-15x'],['Q11-14','Q11-14x'],['Q11-18','Q11-18x'],
['Q11-8','Q11-8x'],['Q11-4','Q11-4x'],['Q11-10','Q11-10x'],['Q11-2','Q11-2x'],['Q11-21','Q11-21x'],['Q11-11','Q11-11x'],['Q11-12','Q11-12x'],['Q14','Q14x'],['Q14-19','Q14-19x'],['Q14-3','Q14-3x'],['Q14-20','Q14-20x'],['Q14-6','Q14-6x'],['Q14-16','Q14-16x'],
['Q14-1','Q14-1x'],['Q14-7','Q14-7x'],['Q14-13','Q14-13x'],['Q14-9','Q14-9x'],['Q14-15','Q14-15x'],['Q14-14','Q14-14x'],['Q14-18','Q14-18x'],['Q14-8','Q14-8x'],['Q14-4','Q14-4x'],['Q14-10','Q14-10x'],['Q14-2','Q14-2x'],['Q14-21','Q14-21x'],['Q14-11','Q14-11x'],
['Q14-12','Q14-12x'],['Q12','Q12x'],['Q12-19','Q12-19x'],['Q12-3','Q12-3x'],['Q12-20','Q12-20x'],['Q12-6','Q12-6x'],['Q12-16','Q12-16x'],['Q12-1','Q12-1x'],['Q12-7','Q12-7x'],['Q12-13','Q12-13x'],['Q12-9','Q12-9x'],['Q12-15','Q12-15x'],['Q12-14','Q12-14x'],
['Q12-18','Q12-18x'],['Q12-8','Q12-8x'],['Q12-4','Q12-4x'],['Q12-10','Q12-10x'],['Q12-2','Q12-2x'],['Q12-21','Q12-21x'],['Q12-11','Q12-11x'],['Q12-12','Q12-12x'],['Q15','Q15x'],['Q15-19','Q15-19x'],['Q15-3','Q15-3x'],['Q15-20','Q15-20x'],['Q15-6','Q15-6x'],
['Q15-16','Q15-16x'],['Q15-1','Q15-1x'],['Q15-7','Q15-7x'],['Q15-13','Q15-13x'],['Q15-9','Q15-9x'],['Q15-15','Q15-15x'],['Q15-14','Q15-14x'],['Q15-18','Q15-18x'],['Q15-8','Q15-8x'],['Q15-4','Q15-4x'],['Q15-10','Q15-10x'],['Q15-2','Q15-2x'],['Q15-21','Q15-21x'],
['Q15-11','Q15-11x'],['Q15-12','Q15-12x'],['Q10','Q10x'],['Q13','Q13x'],['Q13-19','Q13-19x'],['Q13-3','Q13-3x'],['Q13-20','Q13-20x'],['Q13-6','Q13-6x'],['Q13-16','Q13-16x'],['Q13-1','Q13-1x'],['Q13-7','Q13-7x'],['Q13-13','Q13-13x'],['Q13-9','Q13-9x'],
['Q13-15','Q13-15x'],['Q13-14','Q13-14x'],['Q13-18','Q13-18x'],['Q13-8','Q13-8x'],['Q13-4','Q13-4x'],['Q13-10','Q13-10x'],['Q13-2','Q13-2x'],['Q13-21','Q13-21x'],['Q13-11','Q13-11x'],['Q13-12','Q13-12x'],['Q16','Q16x'],['Q16-19','Q16-19x'],['Q16-3','Q16-3x'],
['Q16-20','Q16-20x'],['Q16-6','Q16-6x'],['Q16-16','Q16-16x'],['Q16-1','Q16-1x'],['Q16-7','Q16-7x'],['Q16-13','Q16-13x'],['Q16-9','Q16-9x'],['Q16-15','Q16-15x'],['Q16-14','Q16-14x'],['Q16-18','Q16-18x'],['Q16-8','Q16-8x'],['Q16-4','Q16-4x'],['Q16-10','Q16-10x'],
['Q16-2','Q16-2x'],['Q16-21','Q16-21x'],['Q16-11','Q16-11x'],['Q16-12','Q16-12x'],['Q26','Q26x'],

['Q11x','Q9'],['Q11-19x','Q9-1'],['Q11-3x','Q9-2'],['Q11-20x','Q9-3'],['Q11-6x','Q9-4'],['Q11-16x','Q9-5'],['Q11-1x','Q9-6'],['Q11-7x','Q9-7'],['Q11-13x','Q9-8'],['Q11-9x','Q9-26'],['Q11-15x','Q9-9'],['Q11-14x','Q9-10'],['Q11-18x','Q9-11'],
['Q11-8x','Q9-12'],['Q11-4x','Q9-14'],['Q11-10x','Q9-15'],['Q11-2x','Q9-16'],['Q11-21x','Q9-17'],['Q11-11x','Q9-21'],['Q11-12x','Q9-23'],['Q14x','Q10'],['Q14-19x','Q10-1'],['Q14-3x','Q10-2'],['Q14-20x','Q10-3'],['Q14-6x','Q10-4'],['Q14-16x','Q10-5'],
['Q14-1x','Q10-6'],['Q14-7x','Q10-7'],['Q14-13x','Q10-8'],['Q14-9x','Q10-26'],['Q14-15x','Q10-9'],['Q14-14x','Q10-10'],['Q14-18x','Q10-11'],['Q14-8x','Q10-12'],['Q14-4x','Q10-14'],['Q14-10x','Q10-15'],['Q14-2x','Q10-16'],['Q14-21x','Q10-17'],['Q14-11x','Q10-21'],
['Q14-12x','Q10-23'],['Q12x','Q12'],['Q12-19x','Q12-1'],['Q12-3x','Q12-2'],['Q12-20x','Q12-3'],['Q12-6x','Q12-4'],['Q12-16x','Q12-5'],['Q12-1x','Q12-6'],['Q12-7x','Q12-7'],['Q12-13x','Q12-8'],['Q12-9x','Q12-26'],['Q12-15x','Q12-9'],['Q12-14x','Q12-10'],
['Q12-18x','Q12-11'],['Q12-8x','Q12-12'],['Q12-4x','Q12-14'],['Q12-10x','Q12-15'],['Q12-2x','Q12-16'],['Q12-21x','Q12-17'],['Q12-11x','Q12-21'],['Q12-12x','Q12-23'],['Q15x','Q13'],['Q15-19x','Q13-1'],['Q15-3x','Q13-2'],['Q15-20x','Q13-3'],['Q15-6x','Q13-4'],
['Q15-16x','Q13-5'],['Q15-1x','Q13-6'],['Q15-7x','Q13-7'],['Q15-13x','Q13-8'],['Q15-9x','Q13-26'],['Q15-15x','Q13-9'],['Q15-14x','Q13-10'],['Q15-18x','Q13-11'],['Q15-8x','Q13-12'],['Q15-4x','Q13-14'],['Q15-10x','Q13-15'],['Q15-2x','Q13-16'],['Q15-21x','Q13-17'],
['Q15-11x','Q13-21'],['Q15-12x','Q13-23'],['Q10x','Q14'],['Q13x','Q15'],['Q13-19x','Q15-1'],['Q13-3x','Q15-2'],['Q13-20x','Q15-3'],['Q13-6x','Q15-4'],['Q13-16x','Q15-5'],['Q13-1x','Q15-6'],['Q13-7x','Q15-7'],['Q13-13x','Q15-8'],['Q13-9x','Q15-26'],
['Q13-15x','Q15-9'],['Q13-14x','Q15-10'],['Q13-18x','Q15-11'],['Q13-8x','Q15-12'],['Q13-4x','Q15-14'],['Q13-10x','Q15-15'],['Q13-2x','Q15-16'],['Q13-21x','Q15-17'],['Q13-11x','Q15-21'],['Q13-12x','Q15-23'],['Q16x','Q16'],['Q16-19x','Q16-1'],['Q16-3x','Q16-2'],
['Q16-20x','Q16-3'],['Q16-6x','Q16-4'],['Q16-16x','Q16-5'],['Q16-1x','Q16-6'],['Q16-7x','Q16-7'],['Q16-13x','Q16-8'],['Q16-9x','Q16-26'],['Q16-15x','Q16-9'],['Q16-14x','Q16-10'],['Q16-18x','Q16-11'],['Q16-8x','Q16-12'],['Q16-4x','Q16-14'],['Q16-10x','Q16-15'],
['Q16-2x','Q16-16'],['Q16-21x','Q16-17'],['Q16-11x','Q16-21'],['Q16-12x','Q16-23'],['Q26x','Q32'],
    ),columns=['a', 'b'])

for i in range(new_names.shape[0]):
    try:
        sermo5 = sermo5.rename(columns={ new_names.loc[i,'a'] : new_names.loc[i,'b'] })  
    except:
        print(new_names.loc[i,'a'],new_names.loc[i,'b'])
        continue

del new_names, i
##############################################################################

quest = pd.read_csv('C:/Users/admin/Downloads/sermo-covid-19/sermo-q.csv',header=None)




sermo = pd.concat([sermo5,sermo6,sermo7,sermo8,sermo9,sermo10,sermo12])

#list(sermo5.columns)

del sermo5,sermo6,sermo7,sermo8,sermo9,sermo10,sermo12,file
###################################################################################################################
###################################################################################################################

full_questions = ({ 'Q1': 
                        {
                            1:'Passed the peak of the outbreak',
                            2:'Reached the peak of the outbreak',
                            3:'Not yet reached the peak of the outbreak',
                            4:'Don’t Know'
                        },
                    'Q3':
                        {
                            1:'Within the next week',
                            2:'1-2 weeks from now',
                            3:'3-4 weeks from now',
                            4:'4-5 weeks from now',
                            5:'6-8 weeks from now',
                            6:'Greater than 8 weeks from now',
                            7:'Not sure'
                        },
                    'Q4':
                        {
                            1:'Anyone who wants a COVID-19 test can get one',
                            2:'Anyone that exhibits symptoms or has been exposed to COVID-19 are able to get tested',
                            3:'Only high-risk people that exhibit symptoms of COVID-19 are able to get tested',
                            4:'Not everyone who needs a test has access to one'
                        },
                    'Q5':
                        {
                          1:'Ordered a COVID-19 test for a patient',
                          2:'Treated a patient for COVID-19',
                          3:'Treated a diagnosed COVID-19 patient for an issue unrelated to COVID-19',
                          4:'None of the above',
                          5:'Treated a COVID patient',
                          6:'Have not treated a COVID patient'
                         },    
                    'Q6':
                        {        
                          1:'Within an hour',
                          2:'Within 24 hours',
                          3:'2-3 days',
                          4:'4-5 days',
                          5:'6-7 days',
                          6:'More than 7 days',
                          7:'NET: Within 24 hours',
                          8:'NET: Over 24 hours'
                        },
                    'Q7-1':
                        {  
                          1:'No patients',
                          2:'1-5 patients',
                          3:'6-10 patients',
                          4:'11-15 patients',
                          5:'16-20 patients',
                          6:'21-25 patients',
                          7:'More than 25 patients'
                        },
                    'Q7-2':
                        {  
                          1:'No patients',
                          2:'1-5 patients',
                          3:'6-10 patients',
                          4:'11-15 patients',
                          5:'16-20 patients',
                          6:'21-25 patients',
                          7:'More than 25 patients'
                        },                                
                    'Q7-3':
                        {  
                          1:'No patients',
                          2:'1-5 patients',
                          3:'6-10 patients',
                          4:'11-15 patients',
                          5:'16-20 patients',
                          6:'21-25 patients',
                          7:'More than 25 patients'
                        },                                          
                    'Q20':
                        {  
                          1:'None',
                          2:'NET: At least one',
                          3:'1-5%',
                          4:'6-10%',
                          5:'11-20%',
                          6:'Over 20%',
                          7:'Don’t Know'
                        },
                    'Q21':
                        {  
                          1:'None',
                          2:'NET: At least one',
                          3:'1-5%',
                          4:'6-10%',
                          5:'11-20%',
                          6:'Over 20%',
                          7:'Don’t Know'
                        },                                
                    'Q24':
                        {  
                          1:'Clotting disorders',
                          2:'Renal failure',
                          3:'Heart attack',
                          4:'Cerebral stroke',
                          5:'Inflammation in limbs',
                          6:'Multiple organ failure',
                          7:'Other'
                        },                                 
                    'Q25':
                        {  
                          1:'Medical society',
                          2:'Government agencies',
                          3:'Physician networks',
                          4:'Affiliated Hospital',
                          5:'Colleagues',
                          6:'Journals',
                          7:'Television',
                          8:'Other'
                        },                                   
                    'Q30':
                        {  
                          1:'1',
                          2:'2',
                          3:'3',
                          4:'4 or more'
                        },
                    'Q22':
                        {  
                          1:0,
                          2:1,
                        },
                    'Q29':
                        {  
                          1:0,
                          2:1,
                        },
                    'Q32':
                        {  
                          1:0,
                          2:1,
                        }                 
                    } )  


for Q in full_questions:
    if Q in list(sermo.columns):  
        sermo[Q] = sermo[Q].map(full_questions[Q])

del Q,full_questions


###################################################################################################################
###################################################################################################################

col_dr =['country', 'specialty', 'state', 'respondentId', 'lastInteraction','Q7-1','Q7-2','Q7-3']
responders = sermo.loc[:,col_dr]

responders.loc[:,['Q7-1','Q7-2','Q7-3']] = responders.loc[:,['Q7-1','Q7-2','Q7-3']].replace('No patients', None)

responders['Q7'] = 111 - responders['Q7-1'].isna().apply(int)*100 - responders['Q7-2'].isna().apply(int)*10 - responders['Q7-3'].isna().apply(int)

sermo = sermo.drop(['country', 'specialty', 'state', 'firstInteraction','lastInteraction','Q7-1','Q7-2','Q7-3'],axis=1)

for i in range(quest.shape[0]):
    try:
        responders = responders.rename(columns={ quest.iloc[i,0] : quest.iloc[i,1] })  
    except:
        continue

###################################################################################################################



col_dr =[ 'respondentId',
    'Q9-1','Q9-13','Q10-1','Q10-13','Q12-1','Q12-13','Q13-1','Q13-13','Q15-1','Q15-13','Q16-1','Q16-13',
    'Q9-2','Q9-14','Q10-2','Q10-14','Q12-2','Q12-14','Q13-2','Q13-14','Q15-2','Q15-14','Q16-2','Q16-14',
    'Q9-3','Q9-15','Q10-3','Q10-15','Q12-3','Q12-15','Q13-3','Q13-15','Q15-3','Q15-15','Q16-3','Q16-15',
    'Q9-4','Q9-16','Q10-4','Q10-16','Q12-4','Q12-16','Q13-4','Q13-16','Q15-4','Q15-16','Q16-4','Q16-16',
    'Q9-5','Q9-17','Q10-5','Q10-17','Q12-5','Q12-17','Q13-5','Q13-17','Q15-5','Q15-17','Q16-5','Q16-17',
    'Q9-6','Q9-18','Q10-6','Q10-18','Q12-6','Q12-18','Q13-6','Q13-18','Q15-6','Q15-18','Q16-6','Q16-18',
    'Q9-7','Q9-19','Q10-7','Q10-19','Q12-7','Q12-19','Q13-7','Q13-19','Q15-7','Q15-19','Q16-7','Q16-19',
    'Q9-8','Q9-20','Q10-8','Q10-20','Q12-8','Q12-20','Q13-8','Q13-20','Q15-8','Q15-20','Q16-8','Q16-20',
    'Q9-9','Q9-21','Q10-9','Q10-21','Q12-9','Q12-21','Q13-9','Q13-21','Q15-9','Q15-21','Q16-9','Q16-21',
    'Q9-10','Q9-22','Q10-10','Q10-22','Q12-10','Q12-22','Q13-10','Q13-22','Q15-10','Q15-22','Q16-10','Q16-22',
    'Q9-11','Q9-23','Q10-11','Q10-23','Q12-11','Q12-23','Q13-11','Q13-23','Q15-11','Q15-23','Q16-11','Q16-23',
    'Q9-12','Q9-24','Q10-12','Q10-24','Q12-12','Q12-24','Q13-12','Q13-24','Q15-12','Q15-24','Q16-12','Q16-24',
    'Q9-25','Q10-25','Q12-25','Q13-25','Q14-25','Q15-25','Q16-25','Q9-26','Q10-26','Q12-26','Q13-26','Q14-26','Q15-26','Q16-26',
    'Q9-27','Q10-27','Q12-27','Q13-27','Q14-27','Q15-27','Q16-27']

drugs = pd.DataFrame()

for C in col_dr:
    try:
        drugs[C] = sermo[C]
    except:
        print(C)
        continue


col_del =['studyId','title','label','surveyTime',
    'Q9-1','Q9-13','Q10-1','Q10-13','Q12-1','Q12-13','Q13-1','Q13-13','Q15-1','Q15-13','Q16-1','Q16-13',
    'Q9-2','Q9-14','Q10-2','Q10-14','Q12-2','Q12-14','Q13-2','Q13-14','Q15-2','Q15-14','Q16-2','Q16-14',
    'Q9-3','Q9-15','Q10-3','Q10-15','Q12-3','Q12-15','Q13-3','Q13-15','Q15-3','Q15-15','Q16-3','Q16-15',
    'Q9-4','Q9-16','Q10-4','Q10-16','Q12-4','Q12-16','Q13-4','Q13-16','Q15-4','Q15-16','Q16-4','Q16-16',
    'Q9-5','Q9-17','Q10-5','Q10-17','Q12-5','Q12-17','Q13-5','Q13-17','Q15-5','Q15-17','Q16-5','Q16-17',
    'Q9-6','Q9-18','Q10-6','Q10-18','Q12-6','Q12-18','Q13-6','Q13-18','Q15-6','Q15-18','Q16-6','Q16-18',
    'Q9-7','Q9-19','Q10-7','Q10-19','Q12-7','Q12-19','Q13-7','Q13-19','Q15-7','Q15-19','Q16-7','Q16-19',
    'Q9-8','Q9-20','Q10-8','Q10-20','Q12-8','Q12-20','Q13-8','Q13-20','Q15-8','Q15-20','Q16-8','Q16-20',
    'Q9-9','Q9-21','Q10-9','Q10-21','Q12-9','Q12-21','Q13-9','Q13-21','Q15-9','Q15-21','Q16-9','Q16-21',
    'Q9-10','Q9-22','Q10-10','Q10-22','Q12-10','Q12-22','Q13-10','Q13-22','Q15-10','Q15-22','Q16-10','Q16-22',
    'Q9-11','Q9-23','Q10-11','Q10-23','Q12-11','Q12-23','Q13-11','Q13-23','Q15-11','Q15-23','Q16-11','Q16-23',
    'Q9-12','Q9-24','Q10-12','Q10-24','Q12-12','Q12-24','Q13-12','Q13-24','Q15-12','Q15-24','Q16-12','Q16-24',
     'Q9-25','Q10-25','Q12-25','Q13-25','Q14-25','Q15-25','Q16-25','Q9-26','Q10-26','Q12-26','Q13-26','Q14-26','Q15-26','Q16-26',
    'Q9-27','Q10-27','Q12-27','Q13-27','Q14-27','Q15-27','Q16-27']

for D in col_del:
    try:
        sermo = sermo.drop(D,axis=1)  
    except:
        print(D)
        continue
    

   
     
drugs2 = pd.pivot_table(drugs,index=['respondentId']).stack().reset_index()
 
drugs2['Drug']    = drugs2['level_1'].str.split('-', n = 1, expand = True)[1]       
drugs2['level_1'] = drugs2['level_1'].str.split('-', n = 1, expand = True)[0]


drugs2 = pd.pivot_table(drugs2,columns=['level_1'],index=['respondentId','Drug']).reset_index()

#list(drugs.columns)
drugs2.columns = drugs2.columns.droplevel()

drugs2.columns = ['respondentId', 'Drug' ] + list(drugs2.columns[2:])

drugs2.loc[:,['Q9','Q12','Q15']] = (drugs2.loc[:,['Q9','Q12','Q15']]
                .replace(1,'1. Not Effective').replace(2,'2. Slightly Effective').replace(3,'3. Moderately Effective')
                .replace(4,'5. Very Effective').replace(5,'5. Extremely Effective').replace(6,'N/A') )

drugs2.loc[:,['Q10','Q13','Q16']] = (drugs2.loc[:,['Q10','Q13','Q16']]
                .replace(1,'1. Not At All Safe').replace(2,'3. Somewhat Safe').replace(3,'3. Moderately Safe')
                .replace(4,'4. Very Safe').replace(5,'5. Extremely Safe').replace(6,'N/A') )




for i in range(quest.shape[0]):
    try:
        drugs2 = drugs2.rename(columns={ quest.iloc[i,0] : quest.iloc[i,1] })  
    except:
        continue




###################################################################################################################
###################################################################################################################


for i in range(quest.shape[0]):
    try:
        sermo = sermo.rename(columns={ quest.iloc[i,0] : quest.iloc[i,1] })  
    except:
        continue


sermo['Medic'] =  sermo['Medic (Crit/Sev)']+',' +sermo['Medic (Mild/Mod)']+',' +sermo['Medic (Mod/Sev)']

sermo['Medic'] = sermo['Medic'].apply(lambda x : x if pd.isnull(x) else list(dict.fromkeys( x.split(',') ) ) )



sermo = sermo.sort_index(axis=1).reset_index(drop=True)   

del col_del, col_dr, i, 
del C,D,drugs,quest
list(sermo.columns)

drugs2.to_csv('C:/Users/admin/Downloads/sermo-covid-19/sermo_drug12.csv',index=False)
responders.to_csv('C:/Users/admin/Downloads/sermo-covid-19/sermo_doctors12.csv',index=False)
sermo.to_csv('C:/Users/admin/Downloads/sermo-covid-19/sermo_data12.csv',index=False)

